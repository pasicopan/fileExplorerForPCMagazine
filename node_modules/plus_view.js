var events = require('events');
var fs = require('fs');
var path = require('path');
var util = require('util');
var mime = require('mime');


var currentPath = 'c:';


function Plus(jquery_element) {
    events.EventEmitter.call(this);
    this.element = jquery_element;

    var self = this;
    this.element.delegate('.plus_icon', 'click', function (e) {
        self.execPlus($(this).attr('action'), currentPath,$(this));

        e.stopPropagation();
    });
    // console.log('plus emit is:',self.emit)
}
util.inherits(Plus, events.EventEmitter);

Plus.prototype.execPlus = function (moduleName, path, $) {
        var self = this;
        var psModule = require(moduleName.toLowerCase())[moduleName];
        // console.log('execPlus, moduleName is:',moduleName);
        // console.log('psModule is:',psModule);
        var psmodule = new psModule();
        console.log('path is:',path);
        psmodule.init({
            $:$, 
            path:path,
            callback:function() {
                self.emit('navigate', path);
            }
        });
    }
Plus.prototype.setPath = function (filepath,type) {
        console.log('Plus setPath, filepath is:',filepath);
        currentPath = filepath;
    }


exports.Plus = Plus;
